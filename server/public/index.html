
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fried Beat - Spicy Chicken</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet"/>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #fff8f0;
      color: #333;
    }
    header {
      background-color: #b22222;
      color: #fff;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 40px;
    }
    .nav-left, .nav-right {
      display: flex;
      align-items: center;
      gap: 20px;
    }
    .nav-left a, .nav-right a {
      color: #fff;
      text-decoration: none;
      font-weight: 600;
    }
    .nav-left a:hover, .nav-right a:hover {
      text-decoration: underline;
    }
    .hero {
      background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('images/background.jpg') no-repeat center center/cover;
      height: 450px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 80px;
      color: white;
    }
    .hero h1 {
      font-size: 48px;
    }
    .hero button {
      background-color: #ffc107;
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }
    .popular-items {
      text-align: center;
      margin: 60px 20px;
    }
    .popular-items h2 {
      margin-bottom: 30px;
      font-size: 32px;
    }
    .food-grid {
      display: flex;
      justify-content: center;
      gap: 30px;
      flex-wrap: wrap;
    }
    .food-card {
      background-color: white;
      border-radius: 10px;
      padding: 20px;
      width: 200px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .food-card img {
      width: 100%;
      border-radius: 10px;
    }
    .food-card h3 {
      margin-top: 10px;
      font-size: 18px;
    }
    .food-card p {
      color: #b22222;
      font-weight: bold;
    }
    .modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: white;
      padding: 30px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.3);
      border-radius: 10px;
      z-index: 1000;
      width: 300px;
    }
    .modal input {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      z-index: 900;
    }
    .modal button {
      background: #b22222;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }
    .modal small {
      display: block;
      margin-top: 10px;
      text-align: center;
    }
    #userInfo {
      color: #fff;
      font-weight: bold;
    }
    .admin-dashboard {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 0 20px rgba(0,0,0,0.2);
  z-index: 1001;
  width: 80%;
  max-width: 900px;
  max-height: 80vh;
  overflow: auto;
}

.admin-dashboard table {
  width: 100%;
  border-collapse: collapse;
  margin: 15px 0;
}

.admin-dashboard th, 
.admin-dashboard td {
  padding: 10px;
  border: 1px solid #ddd;
  text-align: left;
}

.admin-dashboard th {
  background-color: #f5f5f5;
}

.delete-btn {
  background: #ff4444;
  color: white;
  border: none;
  padding: 5px 10px;
  border-radius: 4px;
  cursor: pointer;
}

.close-btn {
  display: block;
  margin-top: 15px;
  padding: 8px 15px;
  background: #b22222;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
  </style>
</head>
<body>
  <header>
    <div class="nav-left">
      <a href="#" onclick="goHome()">Home</a>
      <a href="#" id="adminLoginBtn">Admin</a>
    </div>
    <div class="nav-right">
      <a href="#" id="loginBtn">Login</a>
      <a href="#" id="registerBtn">Register</a>
      <div id="userInfo"></div>
    </div>
  </header>

  <section class="hero">
    <div>
      <h1>SPICY FRIED CHICKEN</h1>
    </div>
    <img src="images/chiken-bucket.png" alt="Spicy Chicken Bucket" style="height: 300px;">
  </section>

  <section class="popular-items">
    <h2>Popular Food Items</h2>
    <div class="food-grid">
      <div class="food-card">
        <img src="images/Chicken-pizza.png" alt="Chicken Pizza">
        <h3>Chicken Pizza</h3>
        <p>$12.99</p>
      </div>
      <div class="food-card">
        <img src="images/egg-noodles.png" alt="Egg Noodles">
        <h3>Egg Noodles</h3>
        <p>$8.99</p>
      </div>
      <div class="food-card">
        <img src="images/Chicken-fried-rice.png" alt="Chicken Fried Rice">
        <h3>Chicken Roll</h3>
        <p>$6.99</p>
      </div>
      <div class="food-card">
        <img src="images/Chicken-leg-piece.png" alt="Chicken Leg Piece">
        <h3>Chicken Leg Piece</h3>
        <p>$4.99</p>
      </div>
    </div>
  </section>

  <div class="overlay" id="overlay"></div>

  <div class="modal" id="loginModal">
    <h2>User Login</h2>
    <input type="text" id="usernameInput" placeholder="Username">
    <input type="password" id="passwordInput" placeholder="Password">
    <button onclick="loginUser()">Login</button>
    <small>Don't have an account? <a href="#" id="openRegister">Register</a></small>
  </div>

  <div class="modal" id="registerModal">
    <h2>Register</h2>
    <input type="text" placeholder="Username">
    <input type="email" placeholder="Email">
    <input type="password" placeholder="Password">
    <button>Register</button>
  </div>

  <div class="modal" id="adminModal">
    <h2>Admin Login</h2>
    <input type="text" placeholder="Admin ID">
    <input type="password" placeholder="Password">
    <button>Login</button>
    <small>Don't have an admin account? <a href="#" id="openAdminRegister">Register</a></small>
  </div>

  <div class="modal" id="adminRegisterModal">
    <h2>Admin Register</h2>
    <input type="text" placeholder="Admin Name">
    <input type="email" placeholder="Email">
    <input type="password" placeholder="Password">
    <button>Register</button>
  </div>
<!--java script-->
  <!-- Update your script section in index.html -->
<script>
  const loginBtn = document.getElementById('loginBtn');
  const registerBtn = document.getElementById('registerBtn');
  const adminLoginBtn = document.getElementById('adminLoginBtn');
  const loginModal = document.getElementById('loginModal');
  const registerModal = document.getElementById('registerModal');
  const adminModal = document.getElementById('adminModal');
  const adminRegisterModal = document.getElementById('adminRegisterModal');
  const overlay = document.getElementById('overlay');
  const openRegister = document.getElementById('openRegister');
  const openAdminRegister = document.getElementById('openAdminRegister');
  const userInfo = document.getElementById('userInfo');

  // Store user data when logged in
  let currentUser = null;

  // Event listeners for modals
  loginBtn.onclick = () => {
    loginModal.style.display = 'block';
    overlay.style.display = 'block';
  }
  
  registerBtn.onclick = () => {
    registerModal.style.display = 'block';
    overlay.style.display = 'block';
  }
  
  adminLoginBtn.onclick = () => {
    adminModal.style.display = 'block';
    overlay.style.display = 'block';
  }
  
  openRegister.onclick = () => {
    loginModal.style.display = 'none';
    registerModal.style.display = 'block';
  }
  
  openAdminRegister.onclick = () => {
    adminModal.style.display = 'none';
    adminRegisterModal.style.display = 'block';
  }
  
  overlay.onclick = closeAllModals;

  // Close all modals
  function closeAllModals() {
    loginModal.style.display = 'none';
    registerModal.style.display = 'none';
    adminModal.style.display = 'none';
    adminRegisterModal.style.display = 'none';
    overlay.style.display = 'none';
  }

  // User Registration
  document.querySelector('#registerModal button').onclick = async () => {
  const inputs = document.querySelectorAll('#registerModal input');
  const username = inputs[0].value;
  const email = inputs[1].value;
  const password = inputs[2].value;
  
  if (!username || !email || !password) {
    alert('Please fill all fields');
    return;
  }
  
  try {
    const response = await fetch('http://localhost:8002/register-user', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ 
        fullName: username, 
        email, 
        password 
      })
    });
    
    const data = await response.json();
    
    if (data.error) {
      alert(data.message);
    } else {
      alert('Registration successful! Please login.');
      registerModal.style.display = 'none';
      overlay.style.display = 'none';
      // Clear form
      inputs.forEach(input => input.value = '');
    }
  } catch (error) {
    alert('Registration failed. Please try again.');
    console.error('Registration error:', error);
  }
};

async function loginUser() {
  const email = document.getElementById('usernameInput').value;
  const password = document.getElementById('passwordInput').value;
  
  if (!email || !password) {
    alert('Please enter both email and password');
    return;
  }
  
  try {
    const response = await fetch('http://localhost:8002/login-user', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    });
    
    const data = await response.json();
    
    if (data.error) {
      alert(data.message); // "User not found" or "Invalid password"
    } else {
      // Successful login
      currentUser = data.user;
      userInfo.innerHTML = `Welcome, ${currentUser.fullName}!`;
      loginModal.style.display = 'none';
      overlay.style.display = 'none';
      
      // Store session
      localStorage.setItem('token', data.accessToken);
      localStorage.setItem('user', JSON.stringify(data.user));
      
      // Update UI
      loginBtn.style.display = 'none';
      registerBtn.style.display = 'none';
      const logoutBtn = document.createElement('a');
      logoutBtn.href = '#';
      logoutBtn.textContent = 'Logout';
      logoutBtn.onclick = logoutUser;
      document.querySelector('.nav-right').prepend(logoutBtn);
    }
  } catch (error) {
    alert('Login failed. Please try again later.');
    console.error('Login error:', error);
  }
}
  // User Login
  async function loginUser() {
    const username = document.getElementById('usernameInput').value;
    const password = document.getElementById('passwordInput').value;
    
    if (!username || !password) {
      alert('Please enter both username and password');
      return;
    }
    
    try {
      // In a real app, you would check if it's email or username
      const response = await fetch('http://localhost:8002/login-user', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ 
          email: username, // Using username as email for simplicity
          password 
        })
      });
      
      const data = await response.json();
      
      if (data.error) {
        alert(data.message);
      } else {
        currentUser = data.user;
        userInfo.innerHTML = `Welcome, ${currentUser.fullName}!`;
        loginModal.style.display = 'none';
        overlay.style.display = 'none';
        // Store token in localStorage 
        localStorage.setItem('token', data.accessToken);
        localStorage.setItem('user', JSON.stringify(data.user));
        
        // Hide login/register, show logout
        loginBtn.style.display = 'none';
        registerBtn.style.display = 'none';
        const logoutBtn = document.createElement('a');
        logoutBtn.href = '#';
        logoutBtn.textContent = 'Logout';
        logoutBtn.onclick = logoutUser;
        document.querySelector('.nav-right').prepend(logoutBtn);
      }
    } catch (error) {
      alert('Login failed. Please try again.');
      console.error('Login error:', error);
    }
  }

  // Admin Login
  document.querySelector('#adminModal button').onclick = async () => {
  const inputs = document.querySelectorAll('#adminModal input');
  const email = inputs[0].value;
  const password = inputs[1].value;
  
  if (!email || !password) {
    alert('Please enter both admin email and password');
    return;
  }
  
  try {
    const response = await fetch('http://localhost:8002/login-admin', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    });
    
    const data = await response.json();
    
    if (data.error) {
      alert(data.message);
    } else {
      // Store admin data
      localStorage.setItem('adminToken', data.accessToken);
      localStorage.setItem('admin', JSON.stringify(data.admin));
      
      // Display admin dashboard with users
      showAdminDashboard(data.users);
    }
  } catch (error) {
    alert('Admin login failed. Please try again.');
    console.error('Admin login error:', error);
  }
};
  // Admin Registration
  document.querySelector('#adminRegisterModal button').onclick = async () => {
    const inputs = document.querySelectorAll('#adminRegisterModal input');
    const fullName = inputs[0].value;
    const email = inputs[1].value;
    const password = inputs[2].value;
    
    if (!fullName || !email || !password) {
      alert('Please fill all fields');
      return;
    }
    
    try {
      const response = await fetch('http://localhost:8002/register-admin', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ fullName, email, password })
      });
      
      const data = await response.json();
      
      if (data.error) {
        alert(data.message);
      } else {
        alert('Admin registration successful! Please login.');
        adminRegisterModal.style.display = 'none';
        overlay.style.display = 'none';
        // Clear form
        inputs.forEach(input => input.value = '');
      }
    } catch (error) {
      alert('Admin registration failed. Please try again.');
      console.error('Admin registration error:', error);
    }
  };

  // Show Admin Dashboard
  document.querySelector('#adminModal button').onclick = async () => {
  const inputs = document.querySelectorAll('#adminModal input');
  const email = inputs[0].value;
  const password = inputs[1].value;
  
  if (!email || !password) {
    alert('Please enter both admin email and password');
    return;
  }
  
  try {
    const response = await fetch('http://localhost:8002/login-admin', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    });
    
    const data = await response.json();
    
    if (data.error) {
      alert(data.message); // "Admin not found" or "Invalid password"
    } else {
      // Successful admin login
      showAdminDashboard(data.users); // Pass the users data to dashboard
      
      // Store admin session
      localStorage.setItem('adminToken', data.accessToken);
      localStorage.setItem('admin', JSON.stringify(data.admin));
    }
  } catch (error) {
    alert('Admin login failed. Please try again later.');
    console.error('Admin login error:', error);
  }
};

// Enhanced Admin Dashboard
function showAdminDashboard(users) {
  closeAllModals();
  
  const dashboard = document.createElement('div');
  dashboard.className = 'admin-dashboard';
  dashboard.innerHTML = `
    <h2>User Management</h2>
    <p>Total Registered Users: ${users.length}</p>
    <table>
      <thead>
        <tr>
          <th>No.</th>
          <th>Name</th>
          <th>Email</th>
          <th>Registered On</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        ${users.map((user, index) => `
          <tr>
            <td>${index + 1}</td>
            <td>${user.fullName}</td>
            <td>${user.email}</td>
            <td>${new Date(user.createdAt).toLocaleDateString()}</td>
            <td>
              <button onclick="deleteUser('${user._id}')" class="delete-btn">Delete</button>
            </td>
          </tr>
        `).join('')}
      </tbody>
    </table>
    <button onclick="document.body.removeChild(this.parentNode)" class="close-btn">
      Close Dashboard
    </button>
  `;
  
  document.body.appendChild(dashboard);
}
  // Delete User (Admin function)
  async function deleteUser(userId) {
    if (!confirm('Are you sure you want to delete this user?')) return;
    
    try {
      const token = localStorage.getItem('adminToken');
      const response = await fetch(`http://localhost:8002/all-users/${userId}`, {
        method: 'DELETE',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`
        }
      });
      
      const data = await response.json();
      
      if (data.error) {
        alert(data.message);
      } else {
        alert('User deleted successfully');
        // Refresh the admin dashboard
        const admin = JSON.parse(localStorage.getItem('admin'));
        const adminResponse = await fetch('http://localhost:8002/login-admin', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ 
            email: admin.email,
            password: 'dummy' // In a real app, you should handle this differently
          })
        });
        
        const adminData = await adminResponse.json();
        if (!adminData.error) {
          // Remove existing dashboard if any
          const existingDashboard = document.querySelector('div[style*="position: fixed; top: 0;"]');
          if (existingDashboard) document.body.removeChild(existingDashboard);
          
          showAdminDashboard(adminData.users);
        }
      }
    } catch (error) {
      alert('Failed to delete user');
      console.error('Delete user error:', error);
    }
  }

  // Logout function
  function logoutUser() {
    currentUser = null;
    userInfo.innerHTML = '';
    localStorage.removeItem('token');
    localStorage.removeItem('user');
    
    // Show login/register buttons
    loginBtn.style.display = 'block';
    registerBtn.style.display = 'block';
    
    // Remove logout button
    const logoutBtn = document.querySelector('.nav-right a[onclick="logoutUser"]');
    if (logoutBtn) logoutBtn.remove();
    
    // If admin is logged in, clear admin data too
    localStorage.removeItem('adminToken');
    localStorage.removeItem('admin');
  }

  // Check if user is already logged in on page load
  window.onload = () => {
    const token = localStorage.getItem('token');
    const user = localStorage.getItem('user');
    
    if (token && user) {
      currentUser = JSON.parse(user);
      userInfo.innerHTML = `Welcome, ${currentUser.fullName}!`;
      
      // Hide login/register, show logout
      loginBtn.style.display = 'none';
      registerBtn.style.display = 'none';
      const logoutBtn = document.createElement('a');
      logoutBtn.href = '#';
      logoutBtn.textContent = 'Logout';
      logoutBtn.onclick = logoutUser;
      document.querySelector('.nav-right').prepend(logoutBtn);
    }
  };

  document.addEventListener('keydown', (event) => {
    if (event.key === 'Escape') {
      closeAllModals();
    }
  });
</script>
